!function(){"use strict";angular.module("myApp",["templates","ui.router","slick"])}(),function(){"use strict";angular.module("myApp").config(["$urlRouterProvider","$stateProvider",function(e,n){e.when("","/"),n.state("home",{url:"/",templateUrl:"src/js/app/Home/home.tpl.html",controller:"HomeCtrl",controllerAs:"vm"}).state("main",{url:"/search/:type",templateUrl:"src/js/app/SearchVenue/templates/Main.tpl.html",controller:"SearchVenueCtrl",controllerAs:"vm"}).state("venue",{url:"/venue/:venueID",templateUrl:"src/js/app/SingleVenue/templates/Venue.tpl.html",controller:"SingleVenueCtrl",controllerAs:"vm",resolve:{SingleVenueData:["$stateParams","FSDataService",function(e,n){var s={},t=e.venueID;return n.getVenue(t).then(function(e){return s=e.data.response.venue}).catch(function(e){console.log(e)})}],SimilarVenueData:["$stateParams","FSDataService",function(e,n){var s=e.venueID;return n.getSimilarVenues(s).then(function(e){return e.data.response.similarVenues.items}).catch(function(e){return e})}]}})}])}(),function(){"use strict";angular.module("myApp").run(["$rootScope",function(e){e.$on("$stateChangeSuccess",function(){$("html, body").animate({scrollTop:0},0)})}])}(),angular.module("templates",[]).run(["$templateCache",function(e){e.put("SearchVenue/templates/Main.tpl.html",'<div id=spinner><span id=first class=ball></span> <span id=second class=ball></span> <span id=third class=ball></span></div><div class="container-fluid overlay"><div class=row><div class="col-xs-12 col-sm-6 col-md-6"><div class=input-group><form ng-submit=vm.search()><input type=text ng-model=vm.searchType placeholder="Have a craving here in San Francisco? Type it here..." required> <button class="btn btn-default btn-sm" type=submit loading-bar>Search</button></form></div><div class=SearchVenueFilterContainer><h4 ng-if=vm.venueFilter><p><small>Search Results for <strong>{{vm.searchName | uppercase}}</strong> near<strong>San Francisco, CA</strong></small></p><button class="btn btn-default btn-md" type=button data-toggle=collapse data-target=#collapseExample aria-expanded=false aria-controls=collapseExample drop-down>Show Filters</button></h4><div class=collapse id=collapseExample><div class="well clearfix"><div class=dropDownSearchList><h5><strong>SortBy</strong></h5><ul class=innerDropDownSearchList><li><a href loading-bar sort=-venue.rating>Best Match</a></li><li><a href loading-bar sort=-venue.rating>Highest Rated</a></li><li><a href loading-bar sort=venue.rating>Lowest Rated</a></li></ul></div><div class=dropDownSearchList><h5><strong>Price</strong></h5><ul class=innerDropDownSearchList><li><a href loading-bar sort=-venue.price.tier>Most Expensive</a></li><li><a href loading-bar sort=venue.price.tier>Least Expensive</a></li></ul></div></div></div></div><ul class=searchVenueList><li ng-repeat="venue in vm.venues | orderBy: vm.sortType track by $index"><div class=media><div class="media-left SearchVenuePhotoContainer"><a ui-sref="venue({venueID: venue.venue.id})"><img class="media-object SearchVenuePhoto" src={{venue.venue.photos.groups[0].items[0].prefix}}300x300{{venue.venue.photos.groups[0].items[0].suffix}} alt=...></a></div><div class="media-body searchVenueBody"><p><span class=searchVenueIndex>{{$index + 1}}</span>. <span class=searchVenueRating>{{venue.venue.rating}}</span></p><h4 class=media-heading><a ui-sref="venue({venueID: venue.venue.id})">{{venue.venue.name}}</a></h4><strong>{{vm.duplicate(venue.venue.price.currency, venue.venue.price.tier)}}</strong> &middot; {{venue.venue.categories[0].name}}<br>{{venue.venue.hours.status}}</div><div class="media-right searchVenueAddressContainer"><address class=searchVenueAddress>{{venue.venue.location.address}}<br>{{venue.venue.location.city}},{{venue.venue.location.state}}<br>{{venue.venue.contact.formattedPhone}}</address></div></div><div class=media style="line-height: 1em"><img class=SearchVenueUserPhoto src={{venue.tips[0].user.photo.prefix}}300x300{{venue.tips[0].user.photo.suffix}} alt> <span class=searhVenueUserTip>{{venue.tips[0].text}}</span></div></li></ul></div><div class="col-xs-12 col-sm-6 col-md-6"><div id=mapCanvas style="width: 100%; height: 45em"></div></div></div></div>'),e.put("SingleVenue/templates/Venue.tpl.html",'<div class="container VenueContainer"><div class=row><slick arrows=true speed=300 slides-to-show=5 touch-move=false slides-to-scroll=1 data=vm.venue.photos.groups[0].items init-onload=true responsive=vm.slickBP><div ng-repeat="photo in ::vm.venue.photos.groups[0].items"><div class=img-wrap><img class=img-responsive src={{::photo.prefix}}300x300{{::photo.suffix}} alt><div class=img-info><h4><strong>{{::photo.user.firstName}} {{::photo.user.lastName}}</strong></h4><p>on {{::photo.createdAt | timefilter}}</p></div></div></div></slick><h4 class=text-center><a href=# venue-photo-gallery venueid={{vm.venue.id}}>See all photos</a></h4></div><div class=row><div class=col-md-8><div class="panel panel-default"><div class=panel-body style="padding: 0; padding: 0px 20px"><span class=addressName><h1>{{::vm.venue.name}}</h1><p>{{::vm.venue.categories[0].name}} &middot; {{::vm.venue.categories[1].name}}</p></span><address class=businessInformationContainer><strong><span class=businessRating>{{::vm.venue.rating}}</span> Based on {{::vm.venue.ratingSignals}} ratings</strong><p></p><strong>{{::vm.venue.location.address}}<br>{{::vm.venue.location.city}}, {{::vm.venue.location.state}} {{::vm.venue.location.postalCode}}</strong><br><span class="glyphicon glyphicon-earphone"></span>{{::vm.venue.contact.formattedPhone}}<br><span class="glyphicon glyphicon-new-window"></span> <a href={{::vm.venue.url}}>{{::vm.venue.name | lowercase}}</a></address><address class=businessMenu><span><b>Hours</b>: <strong ng-class="{closedVenue : vm.venue.hours.isOpen == false, openVenue : vm.venue.hours.isOpen == true}">{{::vm.venue.hours.status}}</strong></span> <span><b>Price:</b> <strong class=pricing>{{::vm.venue.attributes.groups[0].summary}}</strong> {{::vm.venue.price.message}}</span> <span ng-repeat="menu in vm.venue.attributes.groups | menufilter"><span ng-if="menu.name === \'Menus\'"><b>Menu</b> <strong class="glyphicon glyphicon-cutlery"></strong> : {{menu.summary}} <a href={{vm.venue.menu.url}}><small>(View Menu)</small></a></span> <span ng-if="menu.name === \'Drinks\'"><b>Drinks</b>: {{menu.summary}}</span></span> <span><b>Visits</b> &middot; {{::vm.venue.stats.visitsCount}}</span> <span><b>Checkins</b>&middot; {{::vm.venue.stats.checkinsCount}}</span></address></div></div></div><div class="col-md-4 pull-right"><div id=venue-canvas style="width: 100%; height: 20em"></div></div></div><div class=row><div class=col-md-9><h2>Recommended Reviews</h2><div class="panel panel-default"><div class=panel-body><span class="userReviewTotalLength userReviewBody"><b>{{::vm.venue.tips.groups[0].items.length}} tips and reviews</b></span> <span class="float-right userReviewBody"><span><b>Sort</b>|</span> <span><a href ng-click="vm.sortType = \'-createdAt\'">Recent |</a></span> <span><a href ng-click="vm.sortType = \'-likes.count\'">Popular</a></span></span></div></div><ul class=userReviewList><li ng-repeat="user in vm.venue.tips.groups[0].items | filter: vm.phraseName| orderBy: vm.sortType | limitTo: vm.reviewLim"><div class=media><div class=media-left><img class="media-object userReviewThumbnails" src={{user.user.photo.prefix}}300x300{{user.user.photo.suffix}}></div><div class=media-body><h5 class=media-heading>{{user.text}}</h5><small class=text-muted>{{user.user.firstName}} {{user.user.lastName}} <strong>&middot;</strong> {{user.createdAt | timefilter}} <strong>&middot;</strong> <span class="glyphicon glyphicon-heart" style="font-size: 0.9em"></span> {{user.likes.count}} likes</small></div></div></li><center><button ng-disabled="vm.reviewLim === vm.venue.tips.groups[0].items.length" view-more-reviews>View More</button><center></center></center></ul></div><div class=col-md-3><div class="panel panel-default"><div class=panel-heading><strong class=businessHoursTitle>More Business Info</strong></div><div class=panel-body><ul class=businessInformationList><li ng-repeat="info in ::vm.venue.attributes.groups">{{::info.items[0].displayName}} - <strong>{{::info.items[0].displayValue}}</strong></li></ul></div></div><h5><strong>You May Also Like</strong></h5><div class=similarVenueContainer ng-repeat="(index, similarVenue) in vm.similarVenues track by $index" ng-click=vm.viewSimilarVenue(vm.similarVenues[index].id)><address style="line-height: 1.1"><a class=similarVenueContainerLink href={{similarVenue.url}}><img class=pull-left src={{similarVenue.categories[0].icon.prefix}}bg_64{{similarVenue.categories[0].icon.suffix}}><h5><a href={{similarVenue.url}}>{{similarVenue.name}}</a></h5><p>{{similarVenue.categories[0].shortName}}</p><small>{{similarVenue.location.address}} ({{similarVenue.location.crossStreet}})</small></a></address></div></div></div></div>')}]),function(){"use strict";angular.module("myApp").value("slickBreakpoints",{breakpoints:[{breakpoint:1024,settings:{slidesToShow:4,slidesToScroll:1,dots:!1}},{breakpoint:800,settings:{slidesToShow:3,slidesToScroll:1,arrows:!1,dots:!1}},{breakpoint:480,settings:{slidesToShow:2,slidesToScroll:1,arrows:!1,dots:!1}}]})}(),function(){"use strict";function e(e){function n(n){return e.get("https://api.foursquare.com/v2/venues/explore?near=San-Francisco&query="+n+"&venuePhotos=1&limit=10&radius=10000&client_id=RHV1ZD3K1SPFECIGDWMOXRVQ3TGNQTUGA0QF1K1GQJ0EICIF&client_secret=4RJLQAZNTF2LE4DCSBHJKNC1BBHDUEQBSHIAFCML4GYPXGNQ&v=20140806").then(function(e){return e.data.response.groups[0].items}).catch(function(e){return e})}function s(n){return e.get("https://api.foursquare.com/v2/venues/"+n+"/?client_id=RHV1ZD3K1SPFECIGDWMOXRVQ3TGNQTUGA0QF1K1GQJ0EICIF&client_secret=4RJLQAZNTF2LE4DCSBHJKNC1BBHDUEQBSHIAFCML4GYPXGNQ&v=20140806")}function t(n){return e.get("https://api.foursquare.com/v2/venues/"+n+"/photos?client_id=RHV1ZD3K1SPFECIGDWMOXRVQ3TGNQTUGA0QF1K1GQJ0EICIF&client_secret=4RJLQAZNTF2LE4DCSBHJKNC1BBHDUEQBSHIAFCML4GYPXGNQ&v=20140806")}function a(n){return e.get("https://api.foursquare.com/v2/venues/"+n+"/similar?client_id=RHV1ZD3K1SPFECIGDWMOXRVQ3TGNQTUGA0QF1K1GQJ0EICIF&client_secret=4RJLQAZNTF2LE4DCSBHJKNC1BBHDUEQBSHIAFCML4GYPXGNQ&v=20140806")}var i={getVenueLocationsByType:n,getVenue:s,getVenuePhotos:t,getSimilarVenues:a};return i}angular.module("myApp").factory("FSDataService",e),e.$inject=["$http"]}(),function(){"use strict";function e(){function e(e){i=[],e.map(function(e){i.push({title:e.venue.name,lat:e.venue.location.lat,lng:e.venue.location.lng})})}function n(){for(var e={center:new google.maps.LatLng(i[0].lat,i[0].lng),zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP},n=new google.maps.Map(document.getElementById("mapCanvas"),e),s=new google.maps.InfoWindow,t=0;t<i.length;t++){var a=i[t],r=new google.maps.LatLng(a.lat,a.lng),o=new google.maps.Marker({position:r,map:n,title:a.title});!function(e,t){google.maps.event.addListener(e,"click",function(){s.setContent("<div style = 'width:80px;min-height:20px'>"+t.title+"</div>"),s.open(n,e)})}(o,a)}}function s(e,n,s){t(e,n,s)}function t(e,n,s){var t=new google.maps.LatLng(e,n),a={center:t,zoom:17},i=new google.maps.Map(document.getElementById("venue-canvas"),a),r=new google.maps.Marker({position:t,map:i}),o=new google.maps.InfoWindow({content:s});o.open(i,r)}var a={setSearchVenueMap:e,setVenueMap:s,getSearchVenueMap:n},i=[];return a}angular.module("myApp").factory("MapService",e)}(),function(){"use strict";function e(){return function(e){var n=["January","Febuary","March","April","May","June","July","August","September","October","November","December]"],s=new Date(parseInt(1e3*e)),t=s.getMonth()+1,a=s.getDate(),i=s.getFullYear();return n[t-1]+" "+a+" "+i}}angular.module("myApp").filter("timefilter",e)}(),function(){"use strict";function e(e,n,s,t){var a=this;a.venues=[],a.time=(new Date).toLocaleTimeString().replace(/:\d+ /," "),a.venueFilter=!1,a.sortType="",a.searchType="",n.getVenueLocationsByType(t.type).then(function(e){a.searchName=a.searchType,a.venues=e,s.setSearchVenueMap(e),s.getSearchVenueMap(),a.venueFilter=!0,a.searchType=""}).catch(function(e){console.log(e)}),a.duplicate=function(e,n){var s,t="";for(s=0;n>s;s+=1)t+=e+" ";return t}}angular.module("myApp").controller("SearchVenueCtrl",e),e.$inject=["$scope","FSDataService","MapService","$stateParams"]}(),function(){"use strict";angular.module("myApp").directive("loadingBar",["$timeout",function(e){return{restrict:"A",link:function(n,s,t){function a(){t.sort&&($("li.activeLink").removeClass(r),$(o).addClass(l),$(u).addClass(i),e(function(){n.vm.sortType=t.sort,n.$digest(),$(u).removeClass(i),$(o).removeClass(l),s.parent().addClass(r)},800)),$(o).addClass(l),$(u).addClass(i),e(function(){$(u).removeClass(i),$(o).removeClass(l)},800)}var i="active",r="activeLink",o=".overlay",l="loadingOverlay",u="#spinner";s.on("click",a)}}}])}(),function(){"use strict";angular.module("myApp").directive("dropDown",function(){return{restrict:"A",link:function(e,n){n.on("click",function(){$(".collapse").collapse()})}}})}(),function(){"use strict";function e(){var e=this;e.searchRequest=function(e){console.log(e)}}angular.module("myApp").controller("HomeCtrl",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,n,s,t,a,i){var r=this;r.venue=t,r.reviewLim=5,r.slickBP=s.breakpoints,r.similarVenues=a,r.hours=[];n.setVenueMap(t.location.lat,t.location.lng,t.name),r.viewSimilarVenue=function(e){i.go("venue",{venueID:e})}}angular.module("myApp").controller("SingleVenueCtrl",e),e.$inject=["$scope","MapService","slickBreakpoints","SingleVenueData","SimilarVenueData","$state"]}(),function(){"use strict";angular.module("myApp").directive("businessHoursToolbar",[function(){return{restrict:"A",scope:{data:"="},link:function(e){var n=[],s=[],t=$("#popoverBusinessHours");e.data.map(function(e){e.days&&(s.push("<strong>"+e.days+"</strong>",e.open[0].renderedTime+"<br />"),n=s.join(" "))}),t.popover({trigger:"focus hover",html:!0,content:n})}}}])}(),function(){"use strict";function e(e){function n(n,s,t){var a=[],i=[],r="original";s.on("click",function(e){e.preventDefault(),$.swipebox(i)}),e.getVenuePhotos(t.venueid).then(function(e){return a=e.data.response.photos.items},function(e){return e}).then(function(e){e.map(function(e){i.push(e.user.lastName?{href:e.prefix+r+e.suffix,title:e.user.firstName+" "+e.user.lastName}:{href:e.prefix+r+e.suffix,title:e.user.firstName})})})}var s={restrict:"A",scope:{venueId:"@"},link:n};return s}angular.module("myApp").directive("venuePhotoGallery",e),e.$inject=["FSDataService"]}(),function(){"use strict";function e(e){function n(n,s){var t=5,a=700;s.on("click",function(){e(function(){n.vm.reviewLim+=t},a)})}var s={restrict:"A",link:n};return s}angular.module("myApp").directive("viewMoreReviews",e),e.$inject=["$timeout"]}(),function(){"use strict";function e(){return function(e){var n=[];return e?n=e.filter(function(e){return"Menus"===e.name?e:"Drinks"===e.name?e:void 0}):void 0}}angular.module("myApp").filter("menufilter",e)}();