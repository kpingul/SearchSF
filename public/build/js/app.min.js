!function(){"use strict";angular.module("myApp",["templates","ui.router","slick","ngAutocomplete"])}(),function(){"use strict";angular.module("myApp").config(["$urlRouterProvider","$stateProvider",function(e,s){e.when("","/"),s.state("home",{url:"/",templateUrl:"src/js/app/Home/templates/home.tpl.html",controller:"HomeCtrl",controllerAs:"vm"}).state("main",{url:"/search/:type/:latLng",templateUrl:"src/js/app/SearchVenue/templates/Main.tpl.html",controller:"SearchVenueCtrl",controllerAs:"vm"}).state("venue",{url:"/venue/:venueID",templateUrl:"src/js/app/SingleVenue/templates/Venue.tpl.html",controller:"SingleVenueCtrl",controllerAs:"vm",resolve:{SingleVenueData:["$stateParams","FSDataService",function(e,s){var a={},n=e.venueID;return s.getVenue(n).then(function(e){return a=e.data.response.venue}).catch(function(e){console.log(e)})}],SimilarVenueData:["$stateParams","FSDataService",function(e,s){var a=e.venueID;return s.getSimilarVenues(a).then(function(e){return e.data.response.similarVenues.items}).catch(function(e){return e})}]}})}])}(),function(){"use strict";angular.module("myApp").run(["$rootScope",function(e){e.$on("$stateChangeStart",function(){$("#overlay").show()}),e.$on("$stateChangeSuccess",function(){$("#overlay").hide(),$("html, body").animate({scrollTop:0},0)})}])}(),angular.module("templates",[]).run(["$templateCache",function(e){e.put("Home/home.tpl.html",'<div class=Main_Search><div id=home-header></div><div class=middle><p class=middle-title-2>Feeling Hungry?</p><p class=middle-title-1><span style="color: #4eaacf"><strong>We\'re</strong></span> here to help!</p><p class=middle-title-3>Type in the food that you are craving here in San Francisco.</p><form ng-submit=vm.searchRequest(vm.searchQuery) class=middle-form><div class=input-group><input type=text id=input class=form-control name=searchTerm placeholder="e.g. Steak or Fries" ng-model=vm.searchQuery ng-minlength=3 ng-maxlength=30 required> <span class=input-group-btn><button class="btn btn-default" ng-disabled=!vm.searchQuery id=search type=submit>SEARCH <i class="fa fa-spinner fa-spin" ng-if=!vm.validResponse></i></button></span></div><div class="alert alert-info" role=alert ng-if=vm.errorResponse style="margin-top: 13px; color: #123D52"><button type=button class=close data-dismiss=alert aria-label=Close><span aria-hidden=true>&times;</span></button> <strong>Cannot find any results with <em>{{::vm.searchQuery}}</em> , please enter another search term.</strong></div></form></div></div><div class=container><div class=row><div class=col-md-12><div class=search_description><h2>Find a new favorite spot</h2><h4>SFSquare helps you analyze the restaurants.</h4></div></div></div><div class="row search_description_options"><div class=col-md-6><span class="fa-stack fa-4x"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-search fa-stack-1x fa-inverse"></i></span><h4><b>1). Enter a Search Term</b></h4><p>Enter the type of food or restaurant you\'re looking for. Examples: pizza, chicken sandwich, oysters, shrimp, etc.</p></div><div class=col-md-6><span class="fa-stack fa-4x"><i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa fa-list fa-stack-1x fa-inverse"></i></span><h4><b>2). Listed Results Displayed</b></h4><p>We will generate a list of possible options around the San Francisco area based on your search term.</p></div></div></div><div class=footer><p><span style="float: left">@SFSquare</span> <span style="float: right">Created by Kirck Pingul</span></p></div>'),e.put("SearchVenue/templates/Main.tpl.html",'<nav class="navbar navbar-default" style="margin-bottom: 0px"><div class=container-fluid><div class=navbar-header><a class=navbar-brand ui-sref=home>San Francisco Square</a></div></div></nav><div id=spinner><span id=first class=ball></span> <span id=second class=ball></span> <span id=third class=ball></span></div><div class=container-fluid><div class=row><div class="col-xs-12 col-sm-6 col-md-6 searchVenueContainer"><div class=SearchVenueFilterContainer><h4 ng-if=vm.venueFilter><p><small>Search Results for <strong>{{vm.searchName | uppercase}}</strong> near<strong>San Francisco, CA</strong></small></p><button class="btn btn-default btn-md" type=button data-toggle=collapse data-target=#collapseExample aria-controls=collapseExample aria-expanded=false>Show Filters</button></h4><div class=collapse id=collapseExample><div class="well clearfix"><div class=dropDownSearchList><h5><strong>SortBy</strong></h5><ul class=innerDropDownSearchList><li><a href loading-bar sort=-venue.rating>Best Match</a></li><li><a href loading-bar sort=-venue.rating>Highest Rated</a></li><li><a href loading-bar sort=venue.rating>Lowest Rated</a></li></ul></div><div class=dropDownSearchList><h5><strong>Price</strong></h5><ul class=innerDropDownSearchList><li><a href loading-bar sort=-venue.price.tier>Most Expensive</a></li><li><a href loading-bar sort=venue.price.tier>Least Expensive</a></li></ul></div></div></div></div><ul class=searchVenueList><li ng-repeat="venue in vm.venues | orderBy: vm.sortType track by $index" ui-sref="venue({venueID: venue.venue.id})"><div class=media><div class="media-left SearchVenuePhotoContainer"><a href><img class="media-object SearchVenuePhoto" ng-src={{venue.venue.photos.groups[0].items[0].prefix}}300x300{{venue.venue.photos.groups[0].items[0].suffix}} alt=...></a></div><div class="media-body searchVenueBody"><p><span class=searchVenueIndex>{{$index + 1}}</span>. <span class=searchVenueRating>{{venue.venue.rating}}</span> <small>Click for more details...</small></p><h4 class=media-heading><a href>{{venue.venue.name}}</a></h4><strong>{{vm.duplicate(venue.venue.price.currency, venue.venue.price.tier)}}</strong> &middot; {{venue.venue.categories[0].name}}<br>{{venue.venue.hours.status}}</div><div class="media-right searchVenueAddressContainer"><address class=searchVenueAddress>{{venue.venue.location.address}}<br>{{venue.venue.location.city}},{{venue.venue.location.state}}<br>{{venue.venue.contact.formattedPhone}}</address></div></div><div class=media style="line-height: 1em"><img class=SearchVenueUserPhoto ng-src={{venue.tips[0].user.photo.prefix}}300x300{{venue.tips[0].user.photo.suffix}} alt> <span class=searhVenueUserTip>{{venue.tips[0].text}}</span></div></li></ul></div><div class="col-xs-12 col-sm-6 col-md-6" style="padding: 0"><div id=mapCanvas style="width: 100%; height: 92%"></div></div></div></div>'),e.put("SingleVenue/templates/Venue.tpl.html",'<nav class="navbar navbar-default" style="margin-bottom: 0px"><div class=container-fluid><div class=navbar-header><a class=navbar-brand ui-sref=home>San Francisco Square</a></div></div></nav><div class="container VenueContainer"><div class=row><slick arrows=true speed=300 slides-to-show=5 touch-move=false slides-to-scroll=1 data=vm.venue.photos.groups[1].items init-onload=true responsive=vm.slickBP><div ng-repeat="photo in ::vm.venue.photos.groups[1].items"><div class=img-wrap><img class=img-responsive ng-src={{::photo.prefix}}300x300{{::photo.suffix}} alt><div class=img-info><h4><strong>{{::photo.user.firstName}} {{::photo.user.lastName}}</strong></h4><p>on {{::photo.createdAt | timefilter}}</p></div></div></div></slick><h4 class=text-center><a href=# venue-photo-gallery venueid={{vm.venue.id}}>See all photos</a></h4></div><div class=row><div class=col-md-8><div class="panel panel-default"><div class=panel-body style="padding: 0; padding: 0px 20px"><span class=addressName><h1>{{::vm.venue.name}}</h1><p>{{::vm.venue.categories[0].name}} &middot; {{::vm.venue.categories[1].name}}</p></span><address class=businessInformationContainer><strong><span class=businessRating>{{::vm.venue.rating}}</span> Based on {{::vm.venue.ratingSignals}} ratings</strong><p></p><strong>{{::vm.venue.location.address}}<br>{{::vm.venue.location.city}}, {{::vm.venue.location.state}} {{::vm.venue.location.postalCode}}</strong><br><span class="glyphicon glyphicon-earphone"></span>{{::vm.venue.contact.formattedPhone}}<br><span class="glyphicon glyphicon-new-window"></span> <a href={{::vm.venue.url}}>{{::vm.venue.name | lowercase}}</a></address><address class=businessMenu><span><b>Hours</b>: <strong ng-class="{closedVenue : vm.venue.hours.isOpen == false, openVenue : vm.venue.hours.isOpen == true}">{{::vm.venue.hours.status}}</strong> <a href data-container=body data-toggle=popover data-placement=top id=popoverBusinessHours data=vm.venue.hours.timeframes business-hours-toolbar>(View hours)</a></span> <span><b>Price:</b> <strong class=pricing>{{::vm.venue.attributes.groups[0].summary}}</strong> {{::vm.venue.price.message}}</span> <span ng-repeat="menu in vm.venue.attributes.groups | menufilter"><span ng-if="menu.name === \'Menus\'"><b>Menu</b> <strong class="glyphicon glyphicon-cutlery"></strong> : {{menu.summary}} <a href={{vm.venue.menu.url}}><small>(View Menu)</small></a></span> <span ng-if="menu.name === \'Drinks\'"><b>Drinks</b>: {{menu.summary}}</span></span> <span><b>Visits</b> &middot; {{::vm.venue.stats.visitsCount}}</span> <span><b>Checkins</b>&middot; {{::vm.venue.stats.checkinsCount}}</span></address></div></div></div><div class="col-md-4 pull-right"><div id=venue-canvas style="width: 100%; height: 20em"></div></div></div><div class=row><div class=col-md-9><h2>Recommended Reviews</h2><div class="panel panel-default"><div class=panel-body><span class="userReviewTotalLength userReviewBody"><b>{{::vm.venue.tips.groups[0].items.length}} tips and reviews</b></span> <span class="float-right userReviewBody"><span><b>Sort</b>|</span> <span><a href ng-click="vm.sortType = \'-createdAt\'">Recent |</a></span> <span><a href ng-click="vm.sortType = \'-likes.count\'">Popular</a></span></span></div></div><ul class=userReviewList><li ng-repeat="user in vm.venue.tips.groups[0].items | filter: vm.phraseName| orderBy: vm.sortType | limitTo: vm.reviewLim"><div class=media><div class=media-left><img class="media-object userReviewThumbnails" ng-src={{user.user.photo.prefix}}300x300{{user.user.photo.suffix}}></div><div class=media-body><h5 class=media-heading>{{user.text}}</h5><small class=text-muted>{{user.user.firstName}} {{user.user.lastName}} <strong>&middot;</strong> {{user.createdAt | timefilter}} <strong>&middot;</strong> <span class="glyphicon glyphicon-heart" style="font-size: 0.9em"></span> {{user.likes.count}} likes</small></div></div></li><center><button ng-disabled="vm.reviewLim === vm.venue.tips.groups[0].items.length" view-more-reviews>View More</button><center></center></center></ul></div><div class=col-md-3><div class="panel panel-default"><div class=panel-heading><strong class=businessHoursTitle>More Business Info</strong></div><div class=panel-body><ul class=businessInformationList><li ng-repeat="info in ::vm.venue.attributes.groups">{{::info.items[0].displayName}} - <strong>{{::info.items[0].displayValue}}</strong></li></ul></div></div><h5><strong>You May Also Like</strong></h5><div class=similarVenueContainer ng-repeat="(index, similarVenue) in vm.similarVenues track by $index" ng-click=vm.viewSimilarVenue(vm.similarVenues[index].id)><address style="line-height: 1.1"><a class=similarVenueContainerLink href><img class=pull-left ng-src={{similarVenue.categories[0].icon.prefix}}bg_64{{similarVenue.categories[0].icon.suffix}}><h5><a href>{{similarVenue.name}}</a></h5><p>{{similarVenue.categories[0].shortName}}</p><small>{{similarVenue.location.address}} ({{similarVenue.location.crossStreet}})</small></a></address></div></div></div></div><div class=footer><p><span style="float: left">@SFSquare</span> <span style="float: right">Created by Kirck Pingul</span></p></div>')}]),function(){"use strict";angular.module("myApp").value("slickBreakpoints",{breakpoints:[{breakpoint:1024,settings:{slidesToShow:4,slidesToScroll:1,dots:!1}},{breakpoint:800,settings:{slidesToShow:3,slidesToScroll:1,arrows:!1,dots:!1}},{breakpoint:480,settings:{slidesToShow:2,slidesToScroll:1,arrows:!1,dots:!1}}]})}(),function(){"use strict";function e(e){function s(s,a){return e.get("/api/venues/"+s+"/"+a).then(function(e){if(e){var s=e.data.response.groups[0].items;return s}}).catch(function(e){return e?e:void 0})}function a(s){return e.get("/api/venue/"+s)}function n(s){return e.get("/api/venue/photos/"+s)}function t(s){return e.get("/api/venue/similar/"+s)}var i={getVenueLocationsByType:s,getVenue:a,getVenuePhotos:n,getSimilarVenues:t};return i}angular.module("myApp").factory("FSDataService",e),e.$inject=["$http"]}(),function(){"use strict";function e(){function e(){return t}function a(e){if(e.length>1){var a=s(e),n=L.map("mapCanvas").setView([a[0].lat,a[0].lng],13);L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",{maxZoom:18,id:"kpingul.cigh5xphi85bbvbm8zujsshq6",accessToken:"pk.eyJ1Ijoia3Bpbmd1bCIsImEiOiJjaWdoNXhxcTk4NHdvdHltNjlzb3FvdnR1In0.tHZ6g1UHifI0spL7JFSy4Q"}).addTo(n);for(var i=0;i<a.length;i++){var r='<div class="media">\n						  <div class="media-left">\n						    <a href="">\n						      <img class="media-object mapVenueImage" height="50"  src="'+a[i].img+'" alt="...">\n						    </a>\n						  </div>\n						  <div class="media-body">\n						    <h4 class="media-heading" id="mapVenueMediaHeading"><span class="mapVenueTitle"><span>'+a[i].title+'</span></span> <small class="mapVenueStatus">('+a[i].status+')</small></h4>\n						    <span class ="mapVenueRating">'+a[i].rating+'</span> <span class ="mapVenueAddress">'+a[i].address+' &#x2022;</span>\n						  	<small class="mapVenueType">'+a[i].type+'</small> &#x2022; <small class="mapVenueUrl"><a href="'+a[i].menu+'">view menu</a></small>\n						  </div>\n						</div>';t.push(L.marker([a[i].lat,a[i].lng]).bindPopup(r,{maxWidth:300,minWidth:200}).addTo(n))}}else{var n=L.map("venue-canvas",{zoomControl:!1}).setView([e[0].lat,e[0].lng],14);L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",{maxZoom:18,id:"kpingul.cigh5xphi85bbvbm8zujsshq6",accessToken:"pk.eyJ1Ijoia3Bpbmd1bCIsImEiOiJjaWdoNXhxcTk4NHdvdHltNjlzb3FvdnR1In0.tHZ6g1UHifI0spL7JFSy4Q"}).addTo(n),L.marker([e[0].lat,e[0].lng]).bindPopup(e[0].title).addTo(n),n.dragging.disable(),n.touchZoom.disable(),n.doubleClickZoom.disable(),n.scrollWheelZoom.disable(),n.tap&&n.tap.disable()}}var n={getSearchVenueMap:a,getAllMarkers:e},t=[];return n}function s(e){var s=[];return e.map(function(e){s.push({id:e.venue.id,type:e.venue.categories[0].name,address:e.venue.location.address,menu:e.venue.menu?e.venue.menu.url:"",rating:e.venue.rating,status:e.venue.hours?e.venue.hours.status:"",img:e.venue.categories[0].icon.prefix+"bg_32"+e.venue.categories[0].icon.suffix,title:e.venue.name,lat:e.venue.location.lat,lng:e.venue.location.lng})}),s}angular.module("myApp").factory("MapService",e)}(),function(){"use strict";function e(e){function s(s){return e.post("/api/data",{title:s}).then(function(){})}var a={storeData:s};return a}angular.module("myApp").factory("SearchAnalytics",e),e.$inject=["$http"]}(),function(){"use strict";function e(){return function(e){var s=["January","Febuary","March","April","May","June","July","August","September","October","November","December]"],a=new Date(parseInt(1e3*e)),n=a.getMonth()+1,t=a.getDate(),i=a.getFullYear();return s[n-1]+" "+t+" "+i}}angular.module("myApp").filter("timefilter",e)}(),function(){"use strict";function e(e,s,a,n,t){var i=this;i.validResponse=!0,i.errorResponse=!1,i.searchRequest=function(e,r){var o=r.geometry.location.lat(),l=r.geometry.location.lng(),u=""+o+","+l;t.storeData(e).then(function(){}),n.getVenueLocationsByType(e,u).then(function(n){i.validResponse=!1,n.length>0?s(function(){i.validResponse=!0,a.transitionTo("main",{type:e,latLng:u})},1200):s(function(){i.errorResponse=!0,i.validResponse=!0,console.log("error")},1200)})}}angular.module("myApp").controller("HomeCtrl",e),e.$inject=["$scope","$timeout","$state","FSDataService","SearchAnalytics"]}(),function(){"use strict";function e(e,s,a,n){var t=this;t.venues=[],t.venueFilter=!1,t.sortType="",t.searchType="",t.query=n.type,t.ll=n.latLng,t.allMarkers=[],t.actMap=function(e){for(var s=0;s<t.allMarkers.length;s++)t.allMarkers[s]._latlng.lat==e&&t.allMarkers[s].openPopup()},s.getVenueLocationsByType(n.type,n.latLng).then(function(e){t.searchName=t.searchType,t.venues=e,a.getSearchVenueMap(e),t.allMarkers=a.getAllMarkers(),t.venueFilter=!0,t.searchType=""}).catch(function(e){console.log(e)}),t.duplicate=function(e,s){var a,n="";for(a=0;s>a;a+=1)n+=e+" ";return n}}angular.module("myApp").controller("SearchVenueCtrl",e),e.$inject=["$scope","FSDataService","MapService","$stateParams"]}(),function(){"use strict";angular.module("myApp").directive("loadingBar",["$timeout",function(e){return{restrict:"A",link:function(s,a,n){function t(){n.sort&&($("li.activeLink").removeClass(r),$(l).addClass(i),e(function(){s.vm.sortType=n.sort,s.$digest(),$(l).removeClass(i),a.parent().addClass(r)},800)),$(overlay).addClass(o),$(l).addClass(i),e(function(){$(l).removeClass(i),$(overlay).removeClass(o)},800)}var i="active",r="activeLink",o="loadingOverlay",l="#spinner";a.on("click",t)}}}])}(),function(){"use strict";function e(e,s,a,n,t,i){var r=this;r.venue=n,r.reviewLim=5,r.slickBP=a.breakpoints,r.similarVenues=t,r.hours=[],r.mapVenue=[{lat:n.location.lat,lng:n.location.lng,title:n.name}],s.getSearchVenueMap(r.mapVenue),r.viewSimilarVenue=function(e){i.go("venue",{venueID:e})}}angular.module("myApp").controller("SingleVenueCtrl",e),e.$inject=["$scope","MapService","slickBreakpoints","SingleVenueData","SimilarVenueData","$state"]}(),function(){"use strict";angular.module("myApp").directive("businessHoursToolbar",[function(){return{restrict:"A",scope:{data:"="},link:function(e){var s=[],a=[],n=$("#popoverBusinessHours");e.data.map(function(e){e.days&&(a.push("<strong>"+e.days+"</strong>",e.open[0].renderedTime+"<br />"),s=a.join(" "))}),n.popover({trigger:"focus hover",html:!0,content:s})}}}])}(),function(){"use strict";function e(e){function s(s,a,n){var t=[],i=[],r="original";a.on("click",function(e){e.preventDefault(),$.swipebox(i)}),e.getVenuePhotos(n.venueid).then(function(e){return t=e.data.response.photos.groups[1].items},function(e){return e}).then(function(e){e.map(function(e){i.push(e.user.lastName?{href:e.prefix+r+e.suffix,title:e.user.firstName+" "+e.user.lastName}:{href:e.prefix+r+e.suffix,title:e.user.firstName})})})}var a={restrict:"A",scope:{venueId:"@"},link:s};return a}angular.module("myApp").directive("venuePhotoGallery",e),e.$inject=["FSDataService"]}(),function(){"use strict";function e(e){function s(s,a){var n=5,t=700;a.on("click",function(){e(function(){s.vm.reviewLim+=n},t)})}var a={restrict:"A",link:s};return a}angular.module("myApp").directive("viewMoreReviews",e),e.$inject=["$timeout"]}(),function(){"use strict";function e(){return function(e){var s=[];return e?s=e.filter(function(e){return"Menus"===e.name?e:"Drinks"===e.name?e:void 0}):void 0}}angular.module("myApp").filter("menufilter",e)}();